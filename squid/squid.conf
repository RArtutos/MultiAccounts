# Configuración básica
http_port 3128
visible_hostname proxy

# Acceso y autenticación
auth_param basic program /usr/lib/squid/basic_ncsa_auth /etc/squid/passwd
auth_param basic children 5
auth_param basic realm Proxy
auth_param basic credentialsttl 2 hours
acl auth_users proxy_auth REQUIRED

# ACLs
acl SSL_ports port 443
acl Safe_ports port 80
acl Safe_ports port 443
acl CONNECT method CONNECT
acl streaming_domains dstdomain .netflix.com .hbomax.com .disneyplus.com

# Reglas
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports
http_access allow streaming_domains auth_users
http_access deny all

# Optimizaciones
cache_mem 256 MB
maximum_object_size 128 MB
cache_dir ufs /var/spool/squid 1024 16 256

# URL rewriter
url_rewrite_program /usr/local/squid/rewriter/main.py
url_rewrite_children 10 startup=5 idle=3 concurrency=0

# Logs
access_log /var/log/squid/access.log
cache_log /var/log/squid/cache.log